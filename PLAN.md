
---

## 1. アプリのゴール整理

**目的：**

* 「A日からB日まで、何日あるか」を**一瞬で・迷いなく**知れること。
* 旅行・締切・プロジェクト・記念日など、**現実のユースケースに即した表現**をしてあげること。

**ターゲット想定：**

* 旅行計画（◯泊◯日）
* 締切までの残り日数
* 記念日までのカウントダウン
* 工程管理の工数ざっくり見積もり

---

## 2. UXの基本方針

1. **入力ストレスを最大限減らす**

   * 日付入力は「カレンダーからポチポチ」＋「キーボード入力」の両立。
   * 「今日」「明日」「今月末」などのクイックボタン。

2. **結果の意味を明確に**

   * 「両端を含む/含まない？」問題をUIでハッキリさせる。
   * 「何泊何日」「残り◯日」など、文脈付きで表示。

3. **すぐシェアできる**

   * URLパラメータで初期値が再現され、リンク1本で再利用可能。

4. **JSなしでも成立＋JSで快適**

   * Hono + SSRを活かして、GETのクエリだけで結果を表示可能に。
   * JSはインタラクティブな体験を補強するために使う。

---

## 3. 画面構成（1ページ完結）

### 3.1 ヘッダー

* タイトル:
  「日数カウンター」 or 「何日ある？計算ツール」
* サブコピー:

  * 例: 「◯年◯月◯日から◯年◯月◯日までの期間を、1クリックで計算します。」

### 3.2 入力エリア

1. **日付入力2つ**

   * ラベル付き：

     * 「開始日」
     * 「終了日」
   * `<input type="date">` を基本としつつ、SSRでは `value` をqueryから埋め込み。
   * TS + date-fnsでサーバー側でもパース。

2. **クイックボタン**

   * 開始日用：

     * 「今日」「昨日」「今週の月曜日」「今月1日」
   * 終了日用：

     * 「今日」「明日」「今週の日曜日」「今月末」
   * ボタン押下で対象の `input[type=date]` をサッと変更。

3. **計算モードの選択**
   チェックボックス or トグルで選択できるように：

   * `□ 開始日と終了日を両方含める（◯日間）`
   * OFFなら「開始日から終了日前日まで（◯泊◯日）」のような定義に。

4. **意味の切り替え（任意だがあると嬉しい）**
   ラジオボタン：

   * 「単純な日数（D日間）」
   * 「◯泊◯日表示（旅行向け）」
   * 「締切までの残り日数（今日を0日として）」など。

5. **タイムゾーン（高度ユーザー向け）**

   * デフォルト：`Asia/Tokyo`（Cloudflare Workersの`request.cf.timezone`が取れればそこから）
   * `select` で `Asia/Tokyo` 以外も選べるようにしておくと、海外在住者にも優しい。
   * date-fns-tzで `zonedTimeToUtc` / `utcToZonedTime` を使用。

### 3.3 結果表示エリア

入力が揃ったら即時に（SSR＋JSで）結果を以下のように表示：

1. **メイン結果（大きめの文字で）**

   * 例1（両端含む）：

     * 「2025年1月1日から2025年1月10日までは **10日間** です。」
   * 例2（旅行モード）：

     * 「2025年1月1日チェックイン、1月10日チェックアウトは **9泊10日** です。」

2. **補足情報**

   * 「開始日を含み、終了日を含む計算です。」など計算ロジックを明文化。
   * `inclusive` オン/オフの状態を文章に反映。

3. **+α情報（オプションでON/OFF）**

   * **平日と週末の内訳**

     * 「平日: 7日、土日: 3日」
   * **経過時間を年月日に分解**

     * 長期の場合：「1年2ヶ月と3日間」など（date-fnsの`intervalToDuration`等で）

4. **アクセシビリティ**

   * `<div aria-live="polite">` などを利用し、結果の更新をスクリーンリーダーでもわかるように。

---

## 4. URL・API仕様（Hono視点）

### 4.1 ルーティング

* `GET /`

  * クエリパラメータ:

    * `from`: `YYYY-MM-DD`
    * `to`: `YYYY-MM-DD`
    * `inclusive`: `0 | 1`
    * `mode`: `"simple" | "trip" | "deadline"`
    * `tz`: IANA timezone (`Asia/Tokyo` など)
  * サーバーで計算 → JSXをSSR → HTML返却

* `GET /api/diff`

  * クエリは上と同じ。
  * レスポンスJSON例：

    ```json
    {
      "from": "2025-01-01",
      "to": "2025-01-10",
      "days": 10,
      "inclusive": true,
      "mode": "trip",
      "nights": 9,
      "weekdays": 7,
      "weekends": 3,
      "timezone": "Asia/Tokyo"
    }
    ```
  * 将来的にSPAや他サービスからの利用も見据えておく。

### 4.2 バリデーション・エラー仕様

* `from`または`to`が欠けている：

  * 入力フォームだけ表示。結果エリアには「日付を選択すると結果が表示されます」とガイド。
* 日付フォーマット不正：

  * 赤字で「日付の形式が不正です（YYYY-MM-DD形式）」など。
* `from > to` の場合：

  * パターン案は2つ：

    1. 自動で入れ替える＋「開始日と終了日を入れ替えました」と小さく表示。
    2. エラーにする。
  * UX重視なら **自動で入れ替え** の方が快適。

---

## 5. フロント側のインタラクション仕様

* SSR時点で計算済みの状態を出す。

* フロントJSでは：

  * 日付入力変更やチェックボックス変更のたびに「計算用URL（/api/diff）」を叩く or クライアント側で再計算。

    * 小さいアプリなので、JS側でdate-fnsを使って**クライアント計算**に寄せるとレスポンスが速く体験が滑らか。
  * 結果をリアルタイム更新。

* URL同期：

  * 入力変更のたびに `history.replaceState` でクエリパラメータを更新。
  * これで「今見ている状態」が常にURLに反映され、シェアしやすい。

---

## 6. Tailwindで意識したいUI要素

* レイアウト

  * 中央寄せの1カラム（`max-w-md mx-auto`）
  * モバイルファースト。
* コンポーネント例

  * ラベル+入力：`flex flex-col gap-1`
  * 結果表示カード：`mt-6 p-4 rounded-xl border shadow-sm`
  * クイックボタン群：`flex flex-wrap gap-2 text-sm`
* 視線誘導

  * メイン結果は `text-2xl font-bold` でドンと表示。
  * サブ情報は `text-sm text-gray-500` など控えめに。

---

## 7. 非機能要件（軽く）

* **パフォーマンス**

  * Cloudflare Workers上なので、バンドルを小さく。
  * date-fnsは使う関数だけimportしてtree-shakingが効くように。
* **トラッキング**

  * 最低限PVを見たいなら、`?utm_source=...`などに対応。
* **プライバシー**

  * Cookie不要。日付情報もサーバー側にはログとして残さない方針を書くと安心感UP。

---

## 8. まとめ

このアプリは機能自体は「日付差を出すだけ」ですが、

* クイックボタン
* 両端含む/含まないの明示
* 旅行/締切など用途別の結果文言
* URLパラメータでシェア可能
* SSR＋クライアント計算のサクサク体験

あたりを丁寧に設計すると、**「他のどの類似サービスよりも使いやすい日数カウンター」**になります。

